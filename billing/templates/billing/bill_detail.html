{% extends "base.html" %}
{% block content %}
<h2>Bill {{ bill.bill_id }}</h2>
<p><strong>Patient:</strong> {{ bill.patient.first_name }} {{ bill.patient.last_name }}</p>
<p><strong>Encounter:</strong> {{ bill.encounter.encounter_id }}</p>
<p><strong>Total Amount:</strong> {{ bill.total_amount }}</p>
<p><strong>Status:</strong> {{ bill.status }}</p>
<p><strong>Bill Date:</strong> {{ bill.bill_date }}</p>
<p><strong>Payment Due:</strong> {{ bill.payment_due }}</p>

<h4>Bill Lines</h4>
<table class="table table-bordered table-striped">
    <thead>
        <tr>
            <th>Type</th>
            <th>Item</th>
            <th>Quantity</th>
            <th>Unit Price</th>
            <th>Line Total</th>
        </tr>
    </thead>
    <tbody>
        {% for line in bill.bill_lines.all %}
        <tr>
            <td>{{ line.line_type }}</td>
            <td>
                {% if line.line_type == 'MEDICATION' %}{{ line.medication.generic_name }}
                {% elif line.line_type == 'PROCEDURE' %}{{ line.procedure.name }}
                {% else %}{{ line.description1 }}{% endif %}
            </td>
            <td>{{ line.quantity }}</td>
            <td>{{ line.unit_price }}</td>
            <td>{{ line.line_total }}</td>
        </tr>
        {% empty %}
        <tr><td colspan="5">No bill lines.</td></tr>
        {% endfor %}
    </tbody>
</table>

<a href="{% url 'billing:bill_edit' bill.pk %}" class="btn btn-warning">Edit</a>
<a href="{% url 'billing:bill_delete' bill.pk %}" class="btn btn-danger">Delete</a>
<a href="{% url 'billing:bill_list' %}" class="btn btn-secondary">Back</a>
{% endblock %}
